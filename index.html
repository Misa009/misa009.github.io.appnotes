<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Notas</title>
  <style>
    /* ==========================================
       iOS Notes Dark ‚Äì Phone-accurate clone
       Single-file web app (GitHub Pages ready)
       ========================================== */

    :root{
      --bg:#000;
      --nav:#1c1c1e;
      --nav-2:#2c2c2e;
      --cell:#1c1c1e;
      --cell-hi:#2c2c2e;
      --cell-press:#3a3a3c;
      --line:#3a3a3c;
      --text:#fff;
      --muted:#a1a1a6;
      --muted-2:#8e8e93;
      --accent:#ffd60a;  /* Notes yellow */
      --danger:#ff453a;
      --blue:#0a84ff;

      --r-lg:16px;
      --r-md:12px;
      --r-sm:10px;

      --font:-apple-system,BlinkMacSystemFont,"SF Pro Text","SF Pro Display",system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family:var(--font);
      -webkit-font-smoothing:antialiased;
      overflow:hidden; /* like app */
    }

    /* ======= App shell ======= */
    .app{
      position:fixed; inset:0;
      display:flex; flex-direction:column;
      background:var(--bg);
    }

    /* ======= iOS nav bars ======= */
    .nav{
      position:relative;
      height:48px;
      padding:0 10px env(safe-area-inset-right) 10px env(safe-area-inset-left);
      display:flex; align-items:center; gap:6px;
      background:rgba(28,28,30,.96);
      border-bottom:1px solid var(--line);
      backdrop-filter:saturate(180%) blur(18px);
      flex:0 0 auto;
    }
    .nav .title{
      font-weight:700; font-size:20px; letter-spacing:.2px;
      color:var(--accent);
      margin:0 auto;
      pointer-events:none;
    }
    .nav .left, .nav .right{
      display:flex; align-items:center; gap:2px; min-width:72px;
    }
    .nav .right{justify-content:flex-end}
    .nav-btn{
      background:transparent; border:0; color:var(--accent);
      font-size:16px; font-weight:600;
      padding:6px 8px; border-radius:8px; cursor:pointer;
    }
    .nav-btn:active{background:#00000040}

    /* Search row under top nav on list screen */
    .search-row{
      background:var(--nav);
      border-bottom:1px solid var(--line);
      padding:8px 10px;
      display:flex; flex-direction:column; gap:8px;
    }
    .folder-line{
      display:flex; align-items:center; gap:8px;
      font-size:13px; color:var(--muted); font-weight:700;
    }
    .folder-line .pill{
      margin-left:auto; font-weight:700; color:var(--muted-2);
    }
    .search{
      width:100%;
      background:var(--nav-2);
      border:1px solid transparent;
      color:var(--text);
      padding:9px 10px;
      font-size:15px;
      border-radius:10px;
      outline:none;
    }
    .search::placeholder{color:var(--muted-2)}

    .count{
      font-size:12px; color:var(--muted-2); font-weight:700;
      padding:0 2px;
    }

    /* ======= Screens (list/editor) ======= */
    .screens{
      position:relative; flex:1; min-height:0; overflow:hidden;
    }
    .screen{
      position:absolute; inset:0;
      display:flex; flex-direction:column; min-height:0;
      transform:translateX(0);
      transition:transform .28s cubic-bezier(.2,.8,.2,1);
      background:var(--bg);
    }
    .screen.hidden-left{ transform:translateX(-100%); }
    .screen.hidden-right{ transform:translateX(100%); }

    /* ======= Notes list ======= */
    .list{
      flex:1; min-height:0; overflow:auto;
      padding:8px 8px 90px;
      background:var(--bg);
    }
    .note-cell{
      background:var(--cell);
      border-radius:12px;
      padding:10px 12px;
      margin-bottom:6px;
      cursor:pointer;
      transition:background .12s ease, transform .02s ease;
      border:1px solid transparent;
    }
    .note-cell:hover{ background:var(--cell-hi); }
    .note-cell:active{ background:var(--cell-press); transform:translateY(1px); }
    .note-title{
      font-size:16px; font-weight:700; line-height:1.2;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
      margin-bottom:4px;
    }
    .note-meta{
      font-size:12px; color:var(--muted-2); font-weight:600;
      display:flex; gap:6px; align-items:center;
    }
    .note-preview{
      font-size:14px; color:#d1d1d6; margin-top:5px;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }

    /* ======= Floating compose ======= */
    .fab{
      position:absolute; right:18px; bottom:18px;
      width:56px; height:56px; border-radius:16px;
      background:var(--accent); color:#000; font-size:26px; font-weight:900;
      display:grid; place-items:center; border:0; cursor:pointer;
      box-shadow:0 14px 38px rgba(0,0,0,.6);
      z-index:5;
    }
    .fab:active{ transform:translateY(1px); }

    /* ======= Editor ======= */
    .editor-top{
      background:var(--nav);
      border-bottom:1px solid var(--line);
      padding:6px 8px;
      display:flex; align-items:center; gap:8px;
    }
    .editor-top .date{
      font-size:12px; color:var(--muted); font-weight:800;
      background:var(--nav-2); padding:6px 8px; border-radius:8px;
    }
    .editor-top .actions{ margin-left:auto; display:flex; gap:6px; }
    .icon-btn{
      width:34px; height:34px; border-radius:9px;
      background:var(--nav-2);
      border:0; color:var(--text); font-size:16px; cursor:pointer;
      display:grid; place-items:center;
    }
    .icon-btn:active{ transform:translateY(1px); }
    .icon-btn.danger{ color:var(--danger); background:#3a2020; }

    textarea{
      flex:1; min-height:0; width:100%;
      background:var(--bg);
      color:var(--text);
      border:0; outline:none; resize:none;
      font-family:var(--font);
      font-size:18px; line-height:1.55;
      padding:16px 14px 120px;
      caret-color:var(--accent);
    }
    textarea::placeholder{ color:var(--muted-2); }

    .empty{
      flex:1; display:flex; align-items:center; justify-content:center;
      flex-direction:column; gap:8px; color:var(--muted);
      text-align:center; padding:30px;
    }
    .empty .big{ font-size:20px; font-weight:800; color:var(--text); opacity:.9; }

    /* ======= Checklist styling (optional) =======
       If line starts with "- [ ]" or "- [x]" we show a hint row in preview only.
       In editor it's plain text (like Notes). */

    /* ======= Tablet split view ======= */
    @media (min-width: 980px){
      body{ overflow:auto; }
      .app{ position:relative; height:100vh; overflow:hidden; }
      .nav{ height:52px; padding:0 12px; }
      .screens{
        display:grid; grid-template-columns:360px 1fr;
      }
      .screen{
        position:relative; inset:auto;
        transition:none; transform:none;
        border-right:1px solid var(--line);
      }
      #editorScreen{ border-right:0; }
      .fab{ right:20px; bottom:20px; }
    }
  </style>
</head>

<body>
  <div class="app">
    <!-- LIST NAV -->
    <div class="nav" id="listNav">
      <div class="left">
        <button class="nav-btn" id="foldersBtn">Carpetas</button>
      </div>
      <div class="title">Notas</div>
      <div class="right">
        <button class="nav-btn" id="listMoreBtn">‚Ä¢‚Ä¢‚Ä¢</button>
      </div>
    </div>

    <!-- EDITOR NAV (shown on phone when editor open) -->
    <div class="nav" id="editorNav" style="display:none;">
      <div class="left">
        <button class="nav-btn" id="backBtn">‚Üê Notas</button>
      </div>
      <div class="title" style="font-size:17px;color:var(--text);font-weight:700;">Notas</div>
      <div class="right">
        <button class="nav-btn" id="editorMoreBtn">‚Ä¢‚Ä¢‚Ä¢</button>
      </div>
    </div>

    <div class="screens">
      <!-- LIST SCREEN -->
      <section class="screen" id="listScreen">
        <div class="search-row">
          <div class="folder-line">
            <span>iCloud</span>
            <span class="pill">Notas</span>
          </div>

          <input class="search" id="searchInput" placeholder="Buscar" />

          <div class="count" id="countLabel">0 notas</div>
        </div>

        <div class="list" id="list"></div>

        <button class="fab" id="newFab" title="Nueva nota">‚úé</button>
      </section>

      <!-- EDITOR SCREEN -->
      <section class="screen hidden-right" id="editorScreen">
        <div class="editor-top" id="editorTop" style="display:none;">
          <div class="date" id="dateLabel"></div>
          <div class="actions">
            <button class="icon-btn" id="shareBtn" title="Compartir">‚§¥Ô∏é</button>
            <button class="icon-btn" id="checkBtn" title="Checklist">‚òëÔ∏é</button>
            <button class="icon-btn danger" id="delBtn" title="Eliminar">üóëÔ∏è</button>
          </div>
        </div>

        <div class="empty" id="emptyState">
          <div class="big">Sin nota seleccionada</div>
          <div>Pulsa el bot√≥n amarillo para crear una.</div>
        </div>
      </section>
    </div>
  </div>

  <script>
    /* ===============================
       Notes Dark Clone ‚Äì Logic
       =============================== */
    const STORAGE_KEY = "notas_ios_dark_phone_v3";

    const seedNotes = [
      { body:
`Marcas de coches
- Mercedes-Benz
- BMW
- Audi
- Volkswagen
- Porsche
- Ferrari
- Lamborghini
- Toyota
- Honda
- Hyundai
- Kia
- Renault
- Peugeot
- SEAT
- Tesla
- BYD
- Volvo
- Ford
- Chevrolet
- Lexus` },
      { body:
`Canciones para rutinas
- Billie Jean ‚Äî Michael Jackson
- Bohemian Rhapsody ‚Äî Queen
- Blinding Lights ‚Äî The Weeknd
- Viva la Vida ‚Äî Coldplay
- Shape of You ‚Äî Ed Sheeran
- Hysteria ‚Äî Muse
- Lose Yourself ‚Äî Eminem
- Titanium ‚Äî David Guetta ft. Sia
- La Flaca ‚Äî Jarabe de Palo
- Mi Gran Noche ‚Äî Raphael` },
      { body:
`Pa√≠ses por continentes
Europa:
- Espa√±a, Francia, Italia, Alemania, Portugal, Reino Unido, Suecia, Noruega, Pa√≠ses Bajos

Am√©rica:
- Canad√°, Estados Unidos, M√©xico, Colombia, Argentina, Chile, Brasil, Per√∫

√Åfrica:
- Marruecos, Egipto, Senegal, Nigeria, Sud√°frica, Kenia

Asia:
- Jap√≥n, China, Corea del Sur, India, Tailandia, Vietnam, Turqu√≠a

Ocean√≠a:
- Australia, Nueva Zelanda, Fiyi` },
      { body:
`Checklist de ejemplo
- [ ] Preparar baraja
- [ ] Cargar NFC
- [ ] Ensayar rutina
- [x] Revisar m√∫sica` }
    ];

    let notes = [];
    let activeId = null;

    // Elements
    const listScreen = document.getElementById("listScreen");
    const editorScreen = document.getElementById("editorScreen");
    const listNav = document.getElementById("listNav");
    const editorNav = document.getElementById("editorNav");
    const listEl = document.getElementById("list");
    const emptyStateEl = document.getElementById("emptyState");
    const editorTopEl = document.getElementById("editorTop");
    const dateLabel = document.getElementById("dateLabel");
    const searchInput = document.getElementById("searchInput");
    const countLabel = document.getElementById("countLabel");
    const newFab = document.getElementById("newFab");
    const backBtn = document.getElementById("backBtn");
    const foldersBtn = document.getElementById("foldersBtn");
    const listMoreBtn = document.getElementById("listMoreBtn");
    const editorMoreBtn = document.getElementById("editorMoreBtn");
    const shareBtn = document.getElementById("shareBtn");
    const delBtn = document.getElementById("delBtn");
    const checkBtn = document.getElementById("checkBtn");

    function uid(){
      return Math.random().toString(36).slice(2) + Date.now().toString(36);
    }
    function nowTs(){ return Date.now(); }

    function firstLine(text){
      const l = (text || "").split("\\n").map(s=>s.trim()).find(Boolean);
      return l || "Sin t√≠tulo";
    }
    function preview(text){
      const lines = (text || "").split("\\n").map(s=>s.trim()).filter(Boolean);
      if(lines.length <= 1) return (lines[0] || "");
      return lines.slice(1).join(" ").slice(0, 90);
    }
    function fmtDate(ts){
      const d = new Date(ts);
      return d.toLocaleDateString("es-ES",{ day:"2-digit", month:"short", year:"numeric" });
    }
    function sortNotes(arr){
      return arr.slice().sort((a,b)=> b.updatedAt - a.updatedAt);
    }

    function load(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw){
        notes = seedNotes.map(n=>({
          id:uid(), body:n.body,
          createdAt:nowTs(), updatedAt:nowTs()
        }));
        save(); return;
      }
      try{ notes = JSON.parse(raw) || []; }
      catch(e){ notes = []; }
    }
    function save(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(notes));
    }

    function renderList(){
      const q = searchInput.value.trim().toLowerCase();
      const filtered = sortNotes(notes).filter(n => (n.body||"").toLowerCase().includes(q));
      listEl.innerHTML = "";

      filtered.forEach(n=>{
        const cell = document.createElement("div");
        cell.className = "note-cell";
        cell.onclick = ()=>openNote(n.id);

        cell.innerHTML = `
          <div class="note-title">${firstLine(n.body)}</div>
          <div class="note-meta">
            <span>${fmtDate(n.updatedAt)}</span>
            <span>‚Ä¢</span>
            <span>${(n.body||"").length} caracteres</span>
          </div>
          <div class="note-preview">${preview(n.body)}</div>
        `;
        listEl.appendChild(cell);
      });

      countLabel.textContent = `${filtered.length} nota${filtered.length!==1?"s":""}`;
    }

    function clearEditor(){
      // remove textarea if exists
      const oldTa = editorScreen.querySelector("textarea");
      if(oldTa) oldTa.remove();
    }

    function renderEditor(){
      clearEditor();
      const note = notes.find(n=>n.id===activeId);
      if(!note){
        editorTopEl.style.display="none";
        emptyStateEl.style.display="flex";
        return;
      }
      emptyStateEl.style.display="none";
      editorTopEl.style.display="flex";
      dateLabel.textContent = fmtDate(note.updatedAt);

      const ta = document.createElement("textarea");
      ta.placeholder = "Escribe tu nota‚Ä¶";
      ta.value = note.body || "";
      ta.oninput = ()=>{
        note.body = ta.value;
        note.updatedAt = nowTs();
        save();
        renderList();
        dateLabel.textContent = fmtDate(note.updatedAt);
      };
      editorScreen.appendChild(ta);
      setTimeout(()=>ta.focus(),0);

      shareBtn.onclick = ()=>{
        navigator.clipboard?.writeText(note.body||"");
        alert("Nota copiada al portapapeles.");
      };
      delBtn.onclick = deleteActive;
      checkBtn.onclick = ()=>toggleChecklistLine(ta);
    }

    function createNote(){
      const n={ id:uid(), body:"", createdAt:nowTs(), updatedAt:nowTs() };
      notes.push(n); save();
      activeId=n.id;
      renderList();
      openEditorScreen();
      renderEditor();
    }

    function deleteActive(){
      if(!activeId) return;
      const note = notes.find(n=>n.id===activeId);
      const title = firstLine(note?.body||"");
      if(!confirm(`¬øEliminar esta nota?\\n\\n"${title}"`)) return;

      notes = notes.filter(n=>n.id!==activeId);
      activeId = notes[0]?.id || null;
      save();
      renderList();
      if(window.matchMedia("(min-width: 980px)").matches){
        renderEditor();
      } else {
        // go back to list on phone
        openListScreen();
      }
    }

    function openNote(id){
      activeId=id;
      renderEditor();
      openEditorScreen();
    }

    function openEditorScreen(){
      if(window.matchMedia("(min-width: 980px)").matches) return; // split view
      listScreen.classList.add("hidden-left");
      editorScreen.classList.remove("hidden-right");
      listNav.style.display="none";
      editorNav.style.display="flex";
    }

    function openListScreen(){
      if(window.matchMedia("(min-width: 980px)").matches) return;
      listScreen.classList.remove("hidden-left");
      editorScreen.classList.add("hidden-right");
      listNav.style.display="flex";
      editorNav.style.display="none";
      activeId=null;
      renderEditor();
    }

    function exportNotes(){
      const data = sortNotes(notes).map(n=>({
        title:firstLine(n.body),
        body:n.body,
        updatedAt:new Date(n.updatedAt).toISOString()
      }));
      const blob=new Blob([JSON.stringify(data,null,2)],{type:"application/json"});
      const url=URL.createObjectURL(blob);
      const a=document.createElement("a");
      a.href=url; a.download="notas-export.json"; a.click();
      URL.revokeObjectURL(url);
    }

    function toggleChecklistLine(ta){
      // iOS Notes inserts "- [ ] " at start of current line
      const start = ta.selectionStart;
      const end = ta.selectionEnd;
      const text = ta.value;

      const lineStart = text.lastIndexOf("\\n", start-1)+1;
      const lineEnd = text.indexOf("\\n", start);
      const ls = lineStart;
      const le = lineEnd===-1? text.length : lineEnd;
      const line = text.slice(ls, le);

      let newLine;
      if(line.trim().startsWith("- [ ]")){
        newLine = line.replace("- [ ]", "- [x]");
      } else if(line.trim().startsWith("- [x]")){
        newLine = line.replace("- [x]", "- [ ]");
      } else {
        newLine = "- [ ] " + line;
      }

      ta.value = text.slice(0, ls) + newLine + text.slice(le);
      const cursor = ls + newLine.length;
      ta.setSelectionRange(cursor, cursor);
      ta.dispatchEvent(new Event("input"));
    }

    // Events
    newFab.onclick=createNote;
    backBtn.onclick=openListScreen;
    searchInput.oninput=renderList;
    listMoreBtn.onclick=exportNotes;
    editorMoreBtn.onclick=exportNotes;
    foldersBtn.onclick=()=>alert("Carpetas es decorativo, igual que en iOS üòâ");

    window.addEventListener("keydown",(e)=>{
      if((e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==="n"){
        e.preventDefault(); createNote();
      }
      if((e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==="f"){
        e.preventDefault(); searchInput.focus();
      }
      if(e.key==="Escape" && !window.matchMedia("(min-width: 980px)").matches){
        openListScreen();
      }
    });

    // Init
    load();
    renderList();
    renderEditor();
  </script>
</body>
</html>
